{% load custom_filters %}

<div class="modal-header">
    <h5 class="modal-title">ðŸ“œ Historial de {{ registro.pid }}</h5>
    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
</div>
<div class="modal-body">
    {% for item in historico %}
        <div class="mb-2 border-bottom pb-2">
            <small class="text-muted">
                {{ item.history.history_date|date:"Y-m-d H:i" }}
                â€“ <b>{{ item.history.history_user|default:"Sistema" }}</b> realizÃ³
            </small>
            <span class="badge bg-warning text-dark ms-2">ModificaciÃ³n</span>
            <ul class="mt-1">
                {% for cambio in item.cambios %}
                    <li>
                        <code>{{ cambio.field }}</code>: 
                        <span class="text-danger">{{ cambio.old|default:"â€”" }}</span>
                        â†’ 
                        <span class="text-success">{{ cambio.new|default:"â€”" }}</span>
                    </li>
                {% endfor %}
            </ul>
        </div>
    {% empty %}
        <p class="text-center text-muted">Sin cambios registrados.</p>
    {% endfor %}
</div>
<div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
</div>
